# –ü–û–õ–ù–ê–Ø –ü–û–î–ù–ê–°–¢–ö–ê –§–£–ù–ö–¶–ò–û–ù–∞–ª—é –ö–£–ü–û–í–ö–ò –ë–ò–õ–ï–¢–û–í

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. **API —Ä—É—á–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** (`app/api/bookings.py`)
   - –ü–µ—Ä–µ–Ω–∞–ø–∏—Å–∞–Ω–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### 2. **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** (`app/repositories/booking_repository.py`)
   - –î–æ–±–∞–≤–ª–µ–Ω—ã `flush()` –∏ `commit()` –≤ –Ω—É–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
   - –ü—Ä–∏–¥–∞–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏

### 3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
   - –û—á–∏—â–µ–Ω–∞ –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∞
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–∑–¥–∞–Ω –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (user_id=1)

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

### –®–ê–ì 1: –û—á–∏—Å—Ç–∏—Ç—å –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É

```bash
# –î–∞–≤–∞–π—Ç–µ –≤ Git Bash:
git pull origin master

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –±–∞–∑—É:
rm -f test.db

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å:
python init_db_complete.py
```

### –®–ê–ì 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç—Å–Ω–æ–≤–æ–π —Å–µ—Ä–≤–µ—Ä

```bash
python main.py
```

### –®–ê–ì 3: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000
2. –ü—Ä–∏–Ω—è—Ç—å —Ä–æ–ª—å **üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**
3. –ù–∞–∂–º–∏—Ç–µ **üõ´ –†–µ–π—Å—ã**
4. –í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π —Ä–µ–π—Å ‚Üí –ù–∞–∂–º–∏—Ç–µ "üéüÔ∏è –ó–ê–ë–†–û–ù–ò–†–û–í–ê–¢–¨"
5. –ù–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **–§–ò–û**: –õ—é–±–æ–µ –∏–º—è
   - **Email**: test@mail.ru
   - **–¢–µ–ª–µ—Ñ–æ–Ω**: +7-999-999-9999
   - **–ö–æ–ª-–≤–æ –º–µ—Å—Ç**: 1
6. –ù–∞–∂–º–∏—Ç–µ "‚úÖ –ë–†–û–ù–ò–†–û–í–ê–¢–¨"
7. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "üé´ –ë–∏–ª–µ—Ç—ã" ‚Üí –ë–∏–ª–µ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è!

## –î–µ–±—É–≥:

### –õ–æ–≥–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

–û—Ç–∫—Ä–æ–π—Ç–µ –≤—ã–≤–æ–¥ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:

```
[API] POST /bookings/ - Starting booking creation
[API] Request data: flight_id=1, passenger=..., seats=1
[API] Checking if flight 1 exists
[API] Flight found: SU-001, available seats: 180
[API] Total price calculated: 5500 (price per seat: 5500)
[API] Generated booking number: BK-12345678
[API] Creating booking in database with: {...}
[API] Booking created successfully: id=1, number=BK-12345678
[API] Updating flight 1 available seats from 180 to 179
[API] Flight updated successfully
[API] POST /bookings/ - Booking created successfully: BK-12345678
```

### –ù–µ—Ç–≤–µ—Ä–∫–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (F12 ‚Üí Network):

- –ü–æ–∫–∞—Ç—å –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã `bookings` POST –∑–∞–ø—Ä–æ—Å
- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –†–µ–∫–æ–∑–Ω–æ—Å—Ç—É: –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å `200` –∏ –¥–∞–Ω–Ω—ã–µ –±–∏–ª–µ—Ç–∞

## –≠—Å—Ç–æ –ú–µ—è—Ç—å—Å—è –ï—Å–ª–∏ –ù–ï –†–∞–±–æ—Ç–∞–µ—Ç:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ö–æ–Ω—Å–æ–ª—å** (F12 ‚Üí Console) –∏ —Å–æ–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏
2. **–°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞** ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ
3. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Ä–∞–∑—É –≤—ã–≤–æ–¥—ã —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ —Ç–æ—á–Ω–æ –æ–∫–æ–ª–æ [API] –∏ [BookingRepo]

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- –ñ–µ–ª–µ–∑–æ DB: SQLite (test.db)
- API –ë–∞–∑–∞ –£–†–õ: http://localhost:8000
- –§—Ä–æ–Ω—Ç–µ–Ω–¥: http://localhost:8000
